(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{C4GF:function(e,t,a){"use strict";var l=a("0ZgE"),u=a("VY4n");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("UsS6");var n=l(a("xqAZ"));a("3PXm");var d=l(a("m2aW"));a("sGLA");var r=l(a("156k"));a("4Ox4");var i=l(a("83Te"));a("pdEl");var c=l(a("0Hx8"));a("sL9k");var s=l(a("BlmP"));a("9sh3");var f=l(a("r3sT"));a("hjcW");var o=l(a("Tmqy")),m=l(a("+wDg")),p=l(a("rFaQ"));a("s/1u");var h=l(a("TMZs")),g=l(a("TFzq")),E=l(a("DEU0")),b=l(a("+hkI")),y=l(a("54rf")),_=l(a("oHNe")),V=l(a("9J9c"));a("6ASg");var v=l(a("pKc7"));a("M50D");var F=l(a("5Zb7"));a("31Pz");var D=l(a("j5+a"));a("0lkx");var k,w,I,C=l(a("gEKc")),S=u(a("bRCM")),q=a("qqji"),P=a("rAnT"),j=(l(a("MDKW")),l(a("lhe0"))),H=l(a("FHVR")),M=l(a("I9Uw")),Y=C.default.TextArea,A=D.default.TabPane,R=F.default.Item,K=v.default.Option,B={labelCol:{span:6},wrapperCol:{span:18}},T="YYYY/MM/DD",x=[],U=[],O=(k=(0,P.connect)(function(e){return e}),w=F.default.create(),k(I=w(I=function(e){function t(){var e,a;(0,g.default)(this,t);for(var l=arguments.length,u=new Array(l),E=0;E<l;E++)u[E]=arguments[E];return a=(0,b.default)(this,(e=(0,y.default)(t)).call.apply(e,[this].concat(u))),a.state={activeKey:"-1",title:"",panes:[],headlist:[],dateStatus:!0,cabinetData:[],idcData:[],BaysData:[],projectlist:[],hostid:0,allprojectids:[],delprojectids:[],haspower:!0},a.handleIdcChange=function(e){a.props.dispatch({type:"gidc/queryIdcRelation",payload:"?tag=cabinet&id=".concat(e)}),a.props.form.setFieldsValue({cabinet_id:a.props.gidc.cabinet.data.map(function(e){return e.title})})},a.handlecabinetChange=function(e){a.props.dispatch({type:"gidc/queryIdcRelation",payload:"?tag=bays&id=".concat(e)}),a.props.form.setFieldsValue({bay_id:a.props.gidc.bays.data.map(function(e){return e.title})})},a.handleProjectLine=function(e){a.props.dispatch({type:"gproline/getProjectGroupbyId",payload:e})},a.handleProjectGroup=function(e){a.props.dispatch({type:"gproline/getProjectbyId",payload:e})},a.projectRemove=function(e){var t=a.props.form,l=t.getFieldValue("keys");1!==l.length&&t.setFieldsValue({keys:l.filter(function(t){return t!==e})})},a.isInArray=function(e,t){for(var a=0;a<e.length;a++)if(t===e[a])return!0;return!1},a.handleSave=function(e){e.preventDefault();var t=a.props.form,l=a.state.dateStatus,u=a.props.gdevice;t.validateFields(function(e,n){if(!e)if(l){if(l){var d,r=(d={serialnumber:t.getFieldValue("serialnumber")?t.getFieldValue("serialnumber"):"",eth1:t.getFieldValue("eth1")?t.getFieldValue("eth1"):"",eth2:t.getFieldValue("eth2")?t.getFieldValue("eth2"):"",eth3:t.getFieldValue("eth3")?t.getFieldValue("eth3"):"",eth4:t.getFieldValue("eth4")?t.getFieldValue("eth4"):"",fqdn:t.getFieldValue("fqdn")?t.getFieldValue("fqdn"):"",internal_ip:t.getFieldValue("internal_ip")?t.getFieldValue("internal_ip"):"",mac:t.getFieldValue("mac")?t.getFieldValue("mac"):"",switch_port:t.getFieldValue("switch_port")?t.getFieldValue("switch_port"):"",start_guaratee:t.getFieldValue("start_guaratee")?t.getFieldValue("start_guaratee").format("YYYY-MM-DD HH:mm:ss"):"",stop_guaratee:t.getFieldValue("stop_guaratee")?t.getFieldValue("stop_guaratee").format("YYYY-MM-DD HH:mm:ss"):"",hardware_vendor:t.getFieldValue("hardware_vendor")?t.getFieldValue("hardware_vendor"):"",manufacturer:t.getFieldValue("manufacturer")?t.getFieldValue("manufacturer"):"",cpu_model:t.getFieldValue("cpu_model")?t.getFieldValue("cpu_model"):"",cpuarch:t.getFieldValue("cpuarch")?t.getFieldValue("cpuarch"):"",num_cpus:t.getFieldValue("num_cpus")?t.getFieldValue("num_cpus"):"",disk:t.getFieldValue("disk")?t.getFieldValue("disk"):"",assets_number:t.getFieldValue("assets_number")?t.getFieldValue("assets_number"):""},(0,p.default)(d,"assets_number",t.getFieldValue("service_code")?t.getFieldValue("service_code"):""),(0,p.default)(d,"assets_number",t.getFieldValue("memory")?t.getFieldValue("memory"):""),(0,p.default)(d,"osversion",t.getFieldValue("osversion")?t.getFieldValue("osversion"):""),(0,p.default)(d,"planversion",t.getFieldValue("planversion")?t.getFieldValue("planversion"):""),(0,p.default)(d,"user_id",t.getFieldValue("user_manger")?t.getFieldValue("user_manger"):""),(0,p.default)(d,"remarks",t.getFieldValue("remarks")?t.getFieldValue("remarks"):""),d);switch(t.getFieldValue("business_id")){case"host已上线":r.businessid=10;break;case"host未下线":r.businessid=9;break;case"host已下线":r.businessid=4;break;default:r.businessid=t.getFieldValue("business_id")}a.state.haspower?r.statusid=2:r.statusid=3,u.hostdetail.data.idc_title===t.getFieldValue("idc_id")?r.idc_id=u.hostdetail.data.idc_ID:r.idc_id=t.getFieldValue("idc_id"),u.hostdetail.data.cabinet_title===t.getFieldValue("cabinet_id")?r.cabinet_id=u.hostdetail.data.cabinet_ID:r.cabinet_id=t.getFieldValue("cabinet_id"),u.hostdetail.data.bays_title===t.getFieldValue("bay_id")?r.bay_id=u.hostdetail.data.bays_ID:r.bay_id=t.getFieldValue("bay_id"),r.project=Array.from(new Set(x)),a.props.dispatch({type:"gdevice/modifyHost",payload:{id:a.props.location.query.id,description:r,cb:function(e){"200"==e.status?h.default.success("修改成功"):h.default.error("修改失败"),x=[],U=[]}}})}}else h.default.error("维保时间必须大于购买时间")})},a.handleSaveProData=function(e,t){x=[],t.map(function(e){e.ID>=1e4?x.push(e.project_id):x.push(e.ID)})},a.handleDeleteProData=function(e,t){x=[],t.map(function(e){e.ID>=1e4?x.push(e.project_id):x.push(e.ID)})},a.HandleSelectHostStatus=function(e){a.props.form.setFieldsValue({business_id:"".concat(e)})},a.handleStatusChange=function(e){a.setState({haspower:e})},a.tabcontent=function(e){var t=a.props.form.getFieldDecorator,l=a.props,u=l.gidc,p=l.gdevice,h=l.ghardware;console.log("this.props",a.props.gidc);var g,E=a.props.gidc.idc.data.map(function(e){return S.default.createElement(K,{key:e.ID,value:e.ID},e.title)});g=0==u.cabinet.data.length?u.cabinet.data.map(function(e){return S.default.createElement(K,{key:"-1",value:"-1"},"请选择")}):(u.cabinet.data||[]).map(function(e){return S.default.createElement(K,{key:e.ID,value:e.ID},e.title)});var b=u.bays.data.map(function(e){return S.default.createElement(K,{key:e.ID,value:e.ID},e.title)}),y=p.user.data.map(function(e){return S.default.createElement(K,{key:e.ID,value:e.ID},e.title)}),_=h.composedata.data.list.map(function(e){return S.default.createElement(K,{key:e.ID,value:e.ID},e.title)});return S.default.createElement(n.default,{bordered:!1},S.default.createElement(F.default,{className:"ant-advanced-search-form",onSubmit:a.handleSave},S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"主机状态"},B),t("business_id",{initialValue:"".concat(e.status.host_business_status_title),rules:[{required:!0,message:"请 选择主机业务状态!"}]})(S.default.createElement(v.default,{placeholder:"请选择",style:{width:"100%"},onChange:a.HandleSelectHostStatus},S.default.createElement(K,{key:"4",value:"4"},"host已下线"),S.default.createElement(K,{key:"9",value:"9"},"host未下线"),S.default.createElement(K,{key:"10",value:"10"},"host已上线"))))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"主机电源"},B),S.default.createElement(f.default,{checkedChildren:"开机",unCheckedChildren:"关机",checked:a.state.haspower,onChange:function(e){return a.handleStatusChange(e)}})))),S.default.createElement(c.default,{style:{marginBottom:32}}),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement("span",null,"网络信息"))),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"网卡1:"},B),t("eth1",{rules:[{required:!0,message:"请输入ip地址!"}],initialValue:"".concat(e.eth1)})(S.default.createElement(C.default,{placeholder:e.eth1})))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"网卡2:"},B),t("eth2",{rules:[{message:"请输入ip地址!"}],initialValue:"".concat(e.eth2)})(S.default.createElement(C.default,{placeholder:e.eth2})))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"主机名(fqdn)"},B),t("fqdn",{rules:[{required:!0,message:"请输入主机名!"}],initialValue:"".concat(e.fqdn)})(S.default.createElement(C.default,{placeholder:e.fqdn}))))),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"网卡3:"},B),t("eth3",{initialValue:"".concat(e.eth3)})(S.default.createElement(C.default,{placeholder:e.eth3})))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"网卡4:"},B),t("eth4",{initialValue:"".concat(e.eth4)})(S.default.createElement(C.default,{placeholder:e.eth4})))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"远程控制卡IP"},B),t("internal_ip",{rules:[{initialValue:"".concat(e.internal_ip)}]})(S.default.createElement(C.default,{placeholder:e.internal_ip}))))),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"MAC地址: "},B),t("mac",{initialValue:"".concat(e.mac)})(S.default.createElement(C.default,{placeholder:e.mac})))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"所在交换机端口: "},B),t("switch_port",{initialValue:"".concat(e.switch_port)})(S.default.createElement(C.default,{placeholder:e.switch_port}))))),S.default.createElement(c.default,{style:{marginBottom:32}}),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement("span",null,"硬件信息"))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"服务器序列号"},B),t("serialnumber",{rules:[{required:!0,message:"请输入序列号!"}],initialValue:"".concat(e.serialnumber)})(S.default.createElement(C.default,{placeholder:"请输入"})))),S.default.createElement(o.default,{span:8,key:1,style:{display:"block"}},S.default.createElement(R,(0,m.default)({label:"机器购买时间"},B),t("start_guaratee",{initialValue:(0,M.default)(e.start_guaratee).isBefore("2006-05-16")?(0,M.default)("2018-05-01",T):(0,M.default)("".concat(e.start_guaratee),T)})(S.default.createElement(i.default,{format:T,onChange:a.newDateChange.bind((0,V.default)((0,V.default)(a)))})))),S.default.createElement(o.default,{span:8,key:2,style:{display:"block"}},S.default.createElement(R,(0,m.default)({label:"机器最后维保"},B),t("stop_guaratee",{initialValue:(0,M.default)(e.start_guaratee).isBefore("2006-05-16")?(0,M.default)("2018-05-02",T):(0,M.default)("".concat(e.stop_guaratee),T)})(S.default.createElement(i.default,{onChange:a.oldDateChange.bind((0,V.default)((0,V.default)(a)))}))))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"服务器生产商"},B),t("hardware_vendor",{initialValue:"".concat(e.hardware_vendor)})(S.default.createElement(C.default,null)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"服务器型号"},B),t("manufacturer",{initialValue:"".concat(e.manufacturer)})(S.default.createElement(C.default,null)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"CPU 参数"},B),t("cpu_model",{initialValue:"".concat(e.cpu_model)})(S.default.createElement(C.default,null))))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"CPU架构"},B),t("cpuarch",{initialValue:"".concat(e.cpuarch)})(S.default.createElement(C.default,null)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"CPU核数"},B),t("num_cpus",{initialValue:"".concat(e.num_cpus)})(S.default.createElement(r.default,null)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"硬盘详情"},B),t("disk",{initialValue:"".concat(e.disk)})(S.default.createElement(C.default,null))))),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"资产编号"},B),t("assets_number",{initialValue:"".concat(e.assets_number)})(S.default.createElement(C.default,null)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"快速服务码"},B),t("service_code",{initialValue:"".concat(e.service_code)})(S.default.createElement(C.default,null)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"内存详情"},B),t("memory",{initialValue:"".concat(e.memory)})(S.default.createElement(C.default,null))))),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"机房选择"},B),t("idc_id",{rules:[{required:!0,message:"请 选择机房选择!"}],initialValue:"".concat(e.idc_title)})(S.default.createElement(v.default,{style:{width:200,marginRight:40},onChange:a.handleIdcChange},E)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"机柜选择"},B),t("cabinet_id",{initialValue:"".concat(e.cabinet_title)})(S.default.createElement(v.default,{style:{width:200,marginRight:40},onChange:a.handlecabinetChange},g)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"机架选择"},B),t("bay_id",{initialValue:"".concat(e.bays_title)})(S.default.createElement(v.default,{style:{width:200,marginRight:40}},b))))),S.default.createElement(c.default,{style:{marginBottom:32}}),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement("span",null,"软件信息"))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"操作系统版本"},B),t("osversion",{initialValue:"".concat(e.osrelease)}),e.osrelease)),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"bios版本"},B),e.biosversion)),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"agent版本"},B),e.agent_version))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"套餐信息"},B),t("planversion",{initialValue:"".concat(e.composeplan)})(S.default.createElement(v.default,{style:{width:200,marginRight:40}},_))))),S.default.createElement(c.default,{style:{marginBottom:32}}),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,{span:8},S.default.createElement("span",null,"权限信息"))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"机器管理员"},B),t("user_manger",{initialValue:"".concat(e.user)})(S.default.createElement(v.default,{style:{width:200,marginRight:40},size:"default"},y)))),S.default.createElement(o.default,{span:8},S.default.createElement(R,(0,m.default)({label:"密码"},B),"*******(请单独修改)"))),S.default.createElement(c.default,{style:{marginBottom:32}}),S.default.createElement("div",{className:H.default.title},"项目信息"),S.default.createElement(s.default,{gutter:24},S.default.createElement(j.default,{hostid:a.state.hostid,projectlist:a.state.projectlist,dispatch:a.props.dispatch,gproline:a.props.gproline,handleSaveProData:a.handleSaveProData,handleDeleteProData:a.handleDeleteProData})),S.default.createElement(c.default,{style:{marginBottom:32}}),S.default.createElement(s.default,{gutter:24},S.default.createElement(o.default,null,S.default.createElement(R,{label:"备注"},t("remarks",{initialValue:"".concat(e.remarks)})(S.default.createElement(Y,{style:{minHeight:32},placeholder:"备注描述",rows:4}))))),S.default.createElement(s.default,null,S.default.createElement(o.default,{span:24,style:{textAlign:"right"}},S.default.createElement(d.default,{type:"primary",htmlType:"submit"},"提交"),S.default.createElement(c.default,{type:"vertical"}),S.default.createElement(d.default,{onClick:function(){return a.reback()}},"返回")))))},a.onChange=function(e){a.setState({activeKey:e})},a.onEdit=function(e,t){a[t](e)},a.reback=function(){var e=a.props,t=e.dispatch,l=(e.match,a.state.activeKey),u=a.state.panes.filter(function(e){return e.key!==l});a.setState({panes:u}),t(q.routerRedux.push({pathname:"/resource/hardware/host/list"}))},a.remove=function(e){var t,l=a.state.activeKey;a.state.panes.forEach(function(a,l){a.key===e&&(t=l-1)});var u=a.state.panes.filter(function(t){return t.key!==e});t>=0&&l===e&&(l=u[t].key),a.setState({panes:u,activeKey:l})},a}return(0,_.default)(t,e),(0,E.default)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,a=t.dispatch,l=t.location,u=this.state,n=u.headlist,d=u.panes;l.hasOwnProperty("query")&&(a({type:"gdevice/queryHostDetail",payload:{id:l.query.id,cb:function(t){if(0!==Object.keys(t).length){var a="".concat(t.detail_id),l=t.fqdn;e.isInArray(n,l)||(n.push(l),d.push({information:t,key:"".concat(a),title:l})),e.setState({panes:d,headlist:n,activeKey:a,projectlist:t.projectlists,hostid:e.props.location.query.id})}2==t.status.host_status_id?e.setState({haspower:!0}):e.setState({haspower:!1})}}}),a({type:"gidc/queryIdcRelation",payload:"?tag=idc"}),a({type:"gproline/getProjectLine"}),a({type:"ghardware/queryHardwarePlan"}),a({type:"gdevice/queryUser"}))}},{key:"newDateChange",value:function(e,t){var a=this.props.form,l=new Date(a.getFieldValue("stop_guaratee")?a.getFieldValue("stop_guaratee"):""),u=new Date(t);"Invalid Date"!=l&&l-u>0?this.setState({dateStatus:!0}):"Invalid Date"!=l&&l-u<0&&(this.setState({dateStatus:!1}),h.default.error("Please confirm that the maintenance time is greater than the purchase time!"))}},{key:"oldDateChange",value:function(e,t){var a=this.props.form,l=new Date(a.getFieldValue("start_guaratee")?a.getFieldValue("start_guaratee"):""),u=new Date(t);"Invalid Date"!=l&&u-l>0?this.setState({dateStatus:!0}):"Invalid Date"!=l&&u-l<0&&(this.setState({dateStatus:!1}),h.default.error("Please confirm that the maintenance time is greater than the purchase time!"))}},{key:"render",value:function(){var e=this;return console.log("projectids",x),S.default.createElement(D.default,{hideAdd:!0,onChange:this.onChange,activeKey:this.state.activeKey,type:"editable-card",onEdit:this.onEdit},this.state.panes.map(function(t){return S.default.createElement(A,{tab:t.title,key:t.key},e.tabcontent(t.information))}))}}]),t}(S.Component))||I)||I);t.default=O}}]);