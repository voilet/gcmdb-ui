(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"5s2z":function(e,t,a){"use strict";var l=a("0ZgE"),n=a("VY4n");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("UsS6");var d=l(a("xqAZ"));a("ggfa");var u=l(a("M+wZ"));a("pdEl");var r=l(a("0Hx8"));a("sGLA");var c=l(a("156k")),i=l(a("+wDg"));a("0lkx");var f=l(a("gEKc"));a("sL9k");var s=l(a("BlmP"));a("hjcW");var o=l(a("Tmqy"));a("8EHj");var m=l(a("6xKx"));a("3PXm");var p=l(a("m2aW"));a("9sh3");var h=l(a("r3sT"));a("xzRB");var y=l(a("TOEs")),E=l(a("bVKW")),b=l(a("U2oY")),g=l(a("TFzq")),v=l(a("DEU0")),k=l(a("+hkI")),S=l(a("54rf")),w=l(a("oHNe"));a("lof2");var x=l(a("Pcfx"));a("M50D");var C=l(a("5Zb7"));a("6ASg");var D,I,F,V=l(a("pKc7")),_=n(a("bRCM")),B=l(a("TXgB")),A=(l(a("MDKW")),a("qqji")),L=a("rAnT"),O=V.default.Option,U=C.default.Item,q=0,z=0,T=function(e,t){x.default[e]({message:"Notification Title",description:t})},K=(D=(0,L.connect)(function(e){return e}),I=C.default.create(),D(F=I(F=function(e){function t(){var e,a;(0,g.default)(this,t);for(var l=arguments.length,n=new Array(l),d=0;d<l;d++)n[d]=arguments[d];return a=(0,k.default)(this,(e=(0,S.default)(t)).call.apply(e,[this].concat(n))),a.state={modalVisible:!1,disabled:!0,cabinetdata:[],baydata:[],idc:[],haspower:!1,addable:!1,baystatus:!1,onSubmit:!1},a.handleSubmit=function(e){var t=a.props.dispatch,l=a.props.form,n=a.state.baydata;e.preventDefault(),l.validateFields(function(e,d){if(!e){var u={title:l.getFieldValue("title")?l.getFieldValue("title"):"",power:l.getFieldValue("power")?l.getFieldValue("power"):"",idcid:l.getFieldValue("idcid")?l.getFieldValue("idcid"):"",cableport:l.getFieldValue("cableport")?l.getFieldValue("cableport"):"",capacity:l.getFieldValue("capacity")?l.getFieldValue("capacity"):"",status:a.state.haspower?"1":"0",bay_details:JSON.stringify(n)};t({type:"gidc/addCabinet",payload:(0,b.default)({},u,{cb:function(e){"200"==e.status?(T("success",e.msg),a.setState({baydata:[],haspower:!1,addable:!1,baystatus:!1,onSubmit:!0}),l.resetFields()):T("error",e.msg)}})})}})},a.handleAdd=function(){var e=a.state.baydata,t={ID:++z,bay_name:"bay"+q++,host_ip:"空 (无法直接修改,请在主机列表关联修改)",host_sn:"空",height:"2U",height_id:2,status:!1,checked:!1};a.setState({baydata:(0,E.default)(e).concat([t]),addable:!0})},a.handleStatusChange=function(e){a.setState({haspower:e})},a.handleBayStatusChange=function(e,t,l){var n=(0,E.default)(a.state.baydata),d=n.filter(function(e){return t===e.ID})[0];d&&(d[l]=e,a.setState({data:n}))},a.handleSelectLineValue=function(e,t,l){var n=(0,E.default)(a.state.baydata),d=n.filter(function(e){return t===e.ID})[0];d&&(d[l]=e,a.setState({data:n}))},a.confirmDelete=function(e){var t=(0,E.default)(a.state.baydata),l=t.filter(function(t){return e===t.ID})[0];if(l){var n=t.indexOf(l);n>-1&&t.splice(n,1),l.tag=!1,a.setState({baydata:t}),a.cacheData=t.map(function(e){return(0,b.default)({},e)})}},a.confirmSave=function(e){var t=(0,E.default)(a.state.baydata),l=t.filter(function(t){return e===t.ID})[0];l&&(l.checked=!0,a.setState({data:t}),a.cacheData=t.map(function(e){return(0,b.default)({},e)}))},a.reback=function(){var e=a.props.dispatch;e({type:"gidc/empty"}),e(A.routerRedux.push({pathname:"/resource/idc/cabinet/list"}))},a.handleSelectChange=function(e){a.setState({onSubmit:!1}),a.props.form.setFieldsValue({idcid:e})},a}return(0,w.default)(t,e),(0,v.default)(t,[{key:"componentWillMount",value:function(){var e=this;(0,this.props.dispatch)({type:"gidc/queryAllIDC",payload:{cb:function(t){"200"==t.status&&e.setState({idc:t.data})}}})}},{key:"handleChange",value:function(e,t,a){var l=(0,E.default)(this.state.data),n=l.filter(function(e){return t===e.ID})[0];n&&(n[a]=e,this.setState({data:l}))}},{key:"render",value:function(){var e=this,t=(this.state.cabinetdata,this.props.form.getFieldDecorator),a={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},l=[{title:"机架名称",dataIndex:"bay_name",width:"100px",editable:!0},{title:"机架高度",dataIndex:"height",width:"50px",render:function(t,a){return _.default.createElement(V.default,{defaultValue:t,disabled:a.selectStatus,style:{width:"150px"},onChange:function(t){return e.handleSelectLineValue(t,a.ID,"height_id")}},_.default.createElement(O,{key:"1",value:"1"},"1U"),_.default.createElement(O,{key:"2",value:"2"},"2U"),_.default.createElement(O,{key:"3",value:"3"},"4U"),_.default.createElement(O,{key:"4",value:"4"},"8U"))}},{title:"服务器IP",dataIndex:"host_ip",width:"100px",render:function(e,t){var a=t.host_ip,l={color:"red"};return _.default.createElement("div",{style:l},a)}},{title:"服务器序列号",dataIndex:"host_sn",width:"100px",render:function(e,t){var a=t.host_sn,l={color:"red"};return _.default.createElement("div",{style:l},a)}},{title:"状态",dataIndex:"checked",width:"50px",render:function(e,t){return t.checked?_.default.createElement(y.default,{type:"check",style:{fontSize:16,color:"#228B22"}}):_.default.createElement(y.default,{type:"close",style:{fontSize:16,color:"#FF0000"}})}},{title:"机架空闲状态",dataIndex:"status",width:"50px",render:function(t,a){var l=a.status;return console.log(l),_.default.createElement("div",null,_.default.createElement(h.default,{checkedChildren:"占用",unCheckedChildren:"空闲",checked:l,onChange:function(t){return e.handleBayStatusChange(t,a.ID,"status")}}))}},{title:"操作",dataIndex:"ID",key:"ID",className:"".concat(B.default.tableOperation),width:"200px",render:function(t,a){return _.default.createElement("div",{className:"editable-row-operations"},_.default.createElement("span",{style:{marginLeft:20}},_.default.createElement("a",{onClick:function(){return e.confirmSave(a.ID)}},_.default.createElement(p.default,null,"保存"))),_.default.createElement("span",null,_.default.createElement(m.default,{title:"确定删除?",onConfirm:function(){return e.confirmDelete(a.ID)}},_.default.createElement("a",{style:{marginLeft:20}},_.default.createElement(p.default,{type:"danger"},"删除")))))}}];return _.default.createElement(d.default,{bordered:!1},_.default.createElement(s.default,{gutter:24,style:{marginBottom:32}},_.default.createElement(o.default,{span:24,key:2,style:{display:"block",fontSize:20}},"机柜信息")),_.default.createElement(C.default,{className:"ant-advanced-search-form",onSubmit:this.handleSubmit},_.default.createElement(s.default,{gutter:24},_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"机柜名称"},a),t("title")(_.default.createElement(f.default,null)))),_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"机柜电量"},a),t("power")(_.default.createElement(f.default,null))))),_.default.createElement(s.default,{gutter:24},_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"所属机房"},a),t("idcid")(_.default.createElement(V.default,{showSearch:!0,style:{width:264},onChange:this.handleSelectChange,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.state.idc.map(function(e,t){return _.default.createElement(O,{key:t,value:e.ID},e.idc_name)}))))),_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"网口数"},a),t("cableport")(_.default.createElement(c.default,{min:1,max:100}))))),_.default.createElement(s.default,{gutter:24},_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"机柜容量"},a),t("capacity")(_.default.createElement(c.default,{min:1,max:100})))),_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"机柜状态"},a),_.default.createElement(h.default,{checkedChildren:"通电",unCheckedChildren:"未通电",checked:this.state.haspower,onChange:function(t){return e.handleStatusChange(t)}})))),_.default.createElement(s.default,{gutter:24},_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"空闲机架"},a))),_.default.createElement(o.default,{span:12},_.default.createElement(U,(0,i.default)({label:"空闲网口"},a)))),_.default.createElement(r.default,{style:{marginBottom:32}}),_.default.createElement(s.default,{gutter:24,style:{marginBottom:32}},_.default.createElement(o.default,{span:24,key:2,style:{display:"block",fontSize:20}},"机架信息")),_.default.createElement(s.default,{gutter:24,style:{marginBottom:32}},_.default.createElement(o.default,{span:24,key:2,style:{display:"block"}},_.default.createElement(p.default,{type:"danger",onClick:this.handleAdd,style:{width:"15%"}},_.default.createElement(y.default,{type:"plus-square"})," 添加机架"))),_.default.createElement(s.default,null,_.default.createElement(u.default,{rowKey:function(e){return e.bay_name},style:{marginBottom:24},bordered:!0,dataSource:this.state.baydata,columns:l})),_.default.createElement(s.default,{gutter:24,style:{marginBottom:32}},_.default.createElement(o.default,{span:24,style:{textAlign:"left"}},_.default.createElement(p.default,{type:"primary",onClick:this.handleSubmit,disabled:this.state.onSubmit},"提交"),_.default.createElement(r.default,{type:"vertical"}),_.default.createElement(p.default,{onClick:function(){return e.reback()}},"返回")))))}}]),t}(_.PureComponent))||F)||F);t.default=K}}]);