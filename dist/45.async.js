(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[45],{"0kyw":function(e,t,a){e.exports={"switch-btn-block":"antd-pro-components-access-role-assign-modal-switch-btn-block","table-block":"antd-pro-components-access-role-assign-modal-table-block"}},GPpn:function(e,t,a){"use strict"},"T/Ci":function(e,t,a){e.exports={tableList:"antd-pro-pages-g-power-role-role-list-tableList",tableListOperator:"antd-pro-pages-g-power-role-role-list-tableListOperator",tableListForm:"antd-pro-pages-g-power-role-role-list-tableListForm",submitButtons:"antd-pro-pages-g-power-role-role-list-submitButtons"}},fepD:function(e,t,a){"use strict";var l=a("4Gf+");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("5QNv");var s=l(a("XRPJ"));a("z4Cl");var i=l(a("L9Tq"));a("PRxM");var d=l(a("C5on"));a("qhfc");var n=l(a("aEti"));a("V1iB");var r=l(a("O2EK"));a("8hBZ");var o=l(a("JCpk")),c=l(a("ZS5U")),h=(l(a("T9cD")),l(a("0kyw"))),p=[{title:"\u8d44\u6e90\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u7c7b\u522b",dataIndex:"rtype",key:"rtype",width:"100px",render:(e,t)=>{var a;return console.log("text",e),a=0==e?c.default.createElement(o.default,{color:"#108ee9"},"\u533a\u57df"):1==e?c.default.createElement(o.default,{color:"#009900"},"\u83dc\u5355"):c.default.createElement(o.default,{color:"#944dff"},"\u6309\u94ae"),c.default.createElement("div",null,a)}},{title:"\u5730\u5740",dataIndex:"link_url",width:"30%",key:"link_url"}],u=(e,t)=>{r.default[e]({message:"\u901a \u77e5 \u680f",description:t})};class f extends c.default.Component{constructor(e){super(e),this.getExpandKeys=(e=>{e.forEach(e=>{1===e.has_licence&&this.selectedRowKeys.push(e.ID),e.children&&(this.expandItem.push(e.ID),this.getExpandKeys(e.children))})}),this.getAssingInfo=(e=>{var t=e,a=this.props.dispatch;a({type:"grole/getRoleResource",payload:{roleid:t,cb:e=>{this.getExpandKeys(e.data),this.initExpandItem()}}}),this.setState({visible:!0}),this.params.roleId=t,this.params.resourceIds=this.selectedRowKeys}),this.initExpandItem=(()=>{var e=this.state,t=e.selectedRowKeys,a=e.expandItem;this.expandItem.forEach(e=>{a.push(e)}),this.selectedRowKeys.forEach(e=>{t.push(e)}),this.setState({expandItem:a,selectedRowKeys:t})}),this.submitAssign=(()=>{console.log("\u5206\u914d\u6210\u529f,\u8bf7\u6c42\u53c2\u6570\u4e3a\uff1a");var e=this.props.dispatch;e({type:"grole/allocateRoleResource",payload:{description:this.params,cb:e=>{"200"==e.status?u("success","\u5206\u914d\u6743\u9650\u6210\u529f!~ ~"):u("error","\u5206\u914d\u6743\u9650\u5931\u8d25!~ ~")}}}),this.setState({visible:!0}),this.init()}),this.cancelAssign=(()=>{this.init()}),this.init=(()=>{var e=this.state.selectedRowKeys;this.params={},this.selectedRowKeys=[],this.expandItem=[],e.splice(0,e.length),this.setState({isExpandAll:!0,visible:!1,selectedRowKeys:e,expandItem:[]})}),this.expandSwitch=(e=>{var t=[];this.expandItem.forEach(e=>{t.push(e)}),this.setState({isExpandAll:e,expandItem:e?t:[]})}),this.expandRow=((e,t)=>{var a=this.state.expandItem;if(e)a.push(t.ID);else{var l=a.indexOf(t.ID);a.splice(l,1)}this.setState({expandItem:a,isExpandAll:a.length===this.expandItem.length})}),this.state={isExpandAll:!0,expandItem:[],selectedRowKeys:[],visible:!1},this.expandItem=[],this.selectedRowKeys=[],this.params={},this.rowSelection={onChange:(e,t)=>{var a=t.map(e=>e.ID);this.params.resourceIds=a},onSelect:(e,t,a)=>{var l=this.state.selectedRowKeys;if(t)l.push(e.ID);else{var s=l.indexOf(e.ID);l.splice(s,1)}this.setState({selectedRowKeys:l})},onSelectAll:(e,t,a)=>{var l=this.state.selectedRowKeys;e?a.forEach(e=>{l.push(e.ID)}):l.splice(0,l.length),this.setState({selectedRowKeys:l})},selectedRowKeys:this.state.selectedRowKeys}}render(){var e=this.props,t=e.assignInfo,a=e.record,l=this.state,r=l.expandItem,o=l.isExpandAll,u=l.visible;return c.default.createElement(c.default.Fragment,null,c.default.createElement(n.default,{onClick:()=>this.getAssingInfo(a)},"\u5206\u914d"),c.default.createElement(s.default,{title:"\u9009\u62e9\u8d44\u6e90",visible:u,onOk:this.submitAssign,onCancel:this.cancelAssign,okText:"\u4fdd\u5b58",width:1e3},c.default.createElement("div",{className:h.default["switch-btn-block"]},c.default.createElement(d.default,{checkedChildren:"\u5168\u90e8\u5c55\u5f00",unCheckedChildren:"\u5168\u90e8\u6536\u7f29",checked:o,onChange:this.expandSwitch})),c.default.createElement("div",{className:h.default["table-block"]},c.default.createElement(i.default,{pagination:!1,columns:p,rowSelection:this.rowSelection,dataSource:t.data,expandedRowKeys:r,onExpand:this.expandRow,rowKey:e=>e.ID}))))}}var m=f;t.default=m},iYqO:function(e,t,a){e.exports={activeChart:"antd-pro-components-access-role-index-activeChart",activeChartGrid:"antd-pro-components-access-role-index-activeChartGrid",activeChartLegend:"antd-pro-components-access-role-index-activeChartLegend"}},obT9:function(e,t,a){"use strict";var l=a("GyWo"),s=a("4Gf+");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("z4Cl");var i=s(a("L9Tq"));a("fr3b");var d=s(a("Bziu"));a("qhfc");var n=s(a("aEti"));a("jYJC");var r=s(a("47AH"));a("9E1Q");var o=s(a("VtQk")),c=s(a("OjS7"));a("oeOs");var h=s(a("AXz3"));a("B5iR");var p=s(a("c0J2")),u=l(a("ZS5U")),f=(s(a("I9Uw")),s(a("iYqO"))),m=s(a("fepD")),v=(p.default.Option,e=>{var t=e.editable,a=e.value,l=e.onChange;return u.default.createElement("div",null,t?u.default.createElement(h.default,{style:{margin:"-5px 0"},value:a,onChange:e=>l(e.target.value)}):a)});class g extends u.PureComponent{constructor(){super(...arguments),this.state={selectedRowKeys:[],totalCallNo:0,data:[],selectedLine:!1},this.handleRowSelectChange=((e,t)=>{var a=t.reduce((e,t)=>{return e+parseFloat(t.callNo,10)},0);this.props.onSelectRow&&this.props.onSelectRow(t),this.setState({selectedRowKeys:e,totalCallNo:a})}),this.handleTableChange=((e,t,a)=>{this.props.onChange(e,t,a)}),this.cleanSelectedKeys=(()=>{this.handleRowSelectChange([],[])})}componentWillReceiveProps(e){0===e.selectedRows.length&&this.setState({selectedRowKeys:[],totalCallNo:0}),e.roledata&&this.setState({data:e.roledata.map(e=>{return void 0==e.selectStatus&&(e.selectStatus=!0),e})})}renderColumns(e,t,a){return u.default.createElement(v,{editable:t.editable,value:e,onChange:e=>this.handleChange(e,t.ID,a)})}edit(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(a.editable=!0,this.setState({data:t}))}save(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(delete a.editable,this.setState({data:t}),this.props.handleSaveData(a))}cancel(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(delete a.editable,this.setState({data:t}))}askdelete(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(a.deleteable=!0,this.setState({data:t}))}confirmdelete(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];if(a){var l=t.indexOf(a);l>-1&&t.splice(l,1),a.tag=!1,this.setState({data:t}),this.cacheData=t.map(e=>(0,c.default)({},e)),this.props.handleDeleteData(a)}}handleChange(e,t,a){console.log("value  ,key,col",e,t,a);var l=[...this.state.data],s=l.filter(e=>t===e.ID)[0];s&&(s[a]=e,this.setState({data:l}))}handleRoleValue(e,t,a){var l=[...this.state.data],s=l.filter(e=>t===e.ID)[0];s&&(s[a]=e,this.setState({data:l,disabled:!1}))}handleSelectLineValue(e,t,a){var l=[...this.state.data],s=l.filter(e=>t===e.ID)[0];s&&(s[a]=e,s["group_title"]="\u8bf7\u9009\u62e9",s["group_id"]="-1",this.props.dispatch({type:"gproline/getProjectGroupbyId",payload:e}),this.setState({data:l,disabled:!1,selectedLine:!0}))}canceldelete(e){var t=[...this.state.data],a=t.filter(t=>e===t.ID)[0];a&&(Object.assign(a,this.cacheData.filter(t=>e===t.ID)[0]),delete a.deleteable,this.setState({data:t}))}render(){var e=this.state,t=e.selectedRowKeys,a=(e.totalCallNo,e.data,this.props),l=a.roledata,s=a.assignInfo,c=[{title:"\u89d2\u8272ID",dataIndex:"ID",key:"ID",width:"120px"},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"title",key:"title",width:"120px",render:(e,t)=>this.renderColumns(e,t,"title")},{title:"\u7528\u6237\u6570",dataIndex:"user_nums",key:"user_nums",width:"150px"},{title:"\u64cd\u4f5c",dataIndex:"operation",key:"operation",width:"200px",render:(e,t)=>{var a=t.editable;t.deleteable;return u.default.createElement("div",{className:"editable-row-operations"},a?u.default.createElement("span",null,u.default.createElement("a",{onClick:()=>this.save(t.ID)},"\u4fdd\u5b58"),u.default.createElement(o.default,{type:"vertical"}),u.default.createElement(r.default,{title:"\u786e\u5b9a\u53d6\u6d88?",onClick:()=>this.cancel(t.ID)},u.default.createElement("a",null,"\u53d6\u6d88"))):u.default.createElement("span",null,u.default.createElement(n.default,{onClick:()=>this.edit(t.ID)},"\u4fee\u6539"),u.default.createElement(o.default,{type:"vertical"})),a?u.default.createElement("span",null):u.default.createElement("span",null,u.default.createElement(r.default,{title:"\u786e\u5b9a\u5220\u9664?",onConfirm:()=>this.confirmdelete(t.ID)},u.default.createElement(n.default,null,"\u5220\u9664")),u.default.createElement("span",null,u.default.createElement(o.default,{type:"vertical"}),u.default.createElement(m.default,{record:t.ID,assignInfo:s,dispatch:this.props.dispatch}))))}}],h={showSizeChanger:!0,showQuickJumper:!0},p={selectedRowKeys:t,onChange:this.handleRowSelectChange,getCheckboxProps:e=>({disabled:e.disabled})};return u.default.createElement("div",{className:f.default.standardTable},u.default.createElement("div",{className:f.default.tableAlert},u.default.createElement(d.default,{message:u.default.createElement("div",null,"\u5df2\u9009\u62e9 ",u.default.createElement("a",{style:{fontWeight:600}},t.length)," \u4e2a\u7528\u6237\xa0",u.default.createElement("a",{onClick:this.cleanSelectedKeys,style:{marginLeft:24}},"\u53d6\u6d88\u52fe\u9009")),type:"info",showIcon:!0})),u.default.createElement(i.default,{rowKey:e=>e.ID,rowSelection:p,dataSource:l,columns:c,pagination:h,onChange:this.handleTableChange}))}}var y=g;t.default=y},yIvT:function(e,t,a){"use strict";var l=a("4Gf+"),s=a("GyWo");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("DxMX");var i=l(a("ivY1"));a("9E1Q");var d=l(a("VtQk"));a("P7WH");var n=l(a("KVOY"));a("sXvm");var r=l(a("0WXq"));a("cqzp");var o=l(a("fMIj")),c=l(a("OjS7"));a("oeOs");var h=l(a("AXz3"));a("B5iR");var p=l(a("c0J2"));a("62OL");var u,f,m,v=l(a("lZ5B")),g=s(a("ZS5U")),y=a("rAnT"),I=l(a("obT9")),w=(l(a("GPpn")),l(a("T/Ci"))),b=(v.default.Item,p.default.Option,e=>Object.keys(e).map(t=>e[t]).join(",")),E=(h.default.TextArea,u=(0,y.connect)(e=>e),f=v.default.create(),u(m=f(m=class extends g.PureComponent{constructor(){super(...arguments),this.state={expandForm:!1,selectedRows:[],formValues:{}},this.handleStandardTableChange=((e,t,a)=>{var l=this.props.dispatch,s=this.state.formValues,i=Object.keys(t).reduce((e,a)=>{var l=(0,c.default)({},e);return l[a]=b(t[a]),l},{}),d=(0,c.default)({currentPage:e.current,pageSize:e.pageSize},s,i);a.field&&(d.sorter=`${a.field}_${a.order}`),l({type:"gproline/getProjectList",payload:d})}),this.handleRefreshTableChange=(()=>{var e=this.props.dispatch;e({type:"gproline/getProjectLine",payload:""})}),this.handleFormReset=(()=>{var e=this.props,t=e.form,a=e.dispatch;t.resetFields(),this.setState({formValues:{}}),a({type:"gproline/getProjectList",payload:{}})}),this.toggleForm=(()=>{this.setState({expandForm:!this.state.expandForm})}),this.handleSelectRows=(e=>{this.setState({selectedRows:e})}),this.handleSaveData=(e=>{var t=e.ID,a=e.title,l={ID:t,title:a};this.props.dispatch({type:"grole/modifyRole",payload:{description:l,cb:e=>{"200"==e.status?openNotificationWithIcon("success","\u5206\u914d\u6743\u9650\u6210\u529f!~ ~"):openNotificationWithIcon("error","\u5206\u914d\u6743\u9650\u5931\u8d25!~ ~")}}})}),this.handleDeleteData=(e=>{var t=e.ID,a={},l=[];l.push(t),a.ids=l,this.props.dispatch({type:"gproline/deleteProject",payload:{tag:!1,infolist:JSON.stringify(a)}})})}componentDidMount(){var e=this.props.dispatch;e({type:"grole/getRolelist"})}render(){var e=this.state,t=e.selectedRows,a=(e.modalVisible,e.addInputValue,this.props.form.getFieldDecorator,this.props),l=a.grole,s=(a.loading,a.submitting,a.dispatch);console.log("grole",l);g.default.createElement(o.default,{onClick:this.handleMenuClick,selectedKeys:[]},g.default.createElement(o.default.Item,{key:"remove"},"\u5220\u9664"),g.default.createElement(o.default.Item,{key:"approval"},"\u6279\u91cf\u542f\u7528"),g.default.createElement(o.default.Item,{key:"stop"},"\u6279\u91cf\u6682\u505c"));return g.default.createElement(i.default,{bordered:!1},g.default.createElement("div",{className:w.default.tableList},g.default.createElement("div",{className:w.default.tableListOperator},g.default.createElement(n.default,{gutter:16},g.default.createElement(r.default,{span:2}))),g.default.createElement(d.default,null," \u89d2\u8272\u5217\u8868 "),g.default.createElement(I.default,{selectedRows:t,dispatch:s,handleSaveData:this.handleSaveData,handleDeleteData:this.handleDeleteData,roledata:l.data,assignInfo:l.assignInfo,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})))}})||m)||m);t.default=E}}]);