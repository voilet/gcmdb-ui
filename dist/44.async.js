(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{"36K2":function(e,t,a){e.exports={tableList:"antd-pro-gcmdb-ui-src-pages-g-power-user-user-list-tableList",tableListOperator:"antd-pro-gcmdb-ui-src-pages-g-power-user-user-list-tableListOperator",tableListForm:"antd-pro-gcmdb-ui-src-pages-g-power-user-user-list-tableListForm",submitButtons:"antd-pro-gcmdb-ui-src-pages-g-power-user-user-list-submitButtons"}},"7TQl":function(e,t,a){"use strict";var l=a("0ZgE"),n=a("VY4n");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("NG6T");var r=l(a("uZXS"));a("9sh3");var d=l(a("r3sT")),u=l(a("+wDg"));a("3PXm");var o=l(a("m2aW")),i=l(a("TFzq")),s=l(a("DEU0")),c=l(a("+hkI")),f=l(a("54rf")),p=l(a("oHNe"));a("lof2");var h=l(a("Pcfx"));a("0lkx");var m=l(a("gEKc"));a("6ASg");var g=l(a("pKc7"));a("M50D");var v,b,y,E=l(a("5Zb7")),w=n(a("bRCM")),C=a("rAnT"),S=E.default.Item,k=g.default.Option,D=(m.default.TextArea,function(e,t){h.default[e]({message:"通 知 栏",description:t})}),I=(v=(0,C.connect)(function(e){return e}),b=E.default.create(),v(y=b(y=function(e){function t(){var e,a;(0,i.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,c.default)(this,(e=(0,f.default)(t)).call.apply(e,[this].concat(n))),a.state={modalVisible:a.props.visible,showFormProline:!0,selectedGroupValue:0,enable:!0},a.handleModalVisible=function(e){a.props.form.resetFields(),a.setState({modalVisible:!!e})},a.handleAdd=function(){var e=a.props.form;e.validateFields(function(e){});var t={username:e.getFieldValue("username")?e.getFieldValue("username"):"",password:e.getFieldValue("password")?e.getFieldValue("password"):"",role:e.getFieldValue("role")?e.getFieldValue("role"):"",realname:e.getFieldValue("realname")?e.getFieldValue("realname"):"",email:e.getFieldValue("email")?e.getFieldValue("email"):"",phone:e.getFieldValue("phone")?e.getFieldValue("phone"):"",enable:a.state.enable};a.props.dispatch({type:"guser/addUser",payload:{description:t,cb:function(e){"200"==e.status?D("success","添加用户成功!~ ~"):D("error","添加用户失败!~ ~")}}}),a.setState({modalVisible:!1}),e.resetFields()},a.handleSelectLineValue=function(e){console.log(e),a.props.dispatch({type:"gproline/getProjectGroupbyId",payload:e})},a.handleSelectGroupValue=function(e){a.setState({selectedGroupValue:e})},a.handleStatusChange=function(e){e?a.setState({enable:"on"}):a.setState({enable:"off"})},a}return(0,p.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,l=(a.submitting,a.form,a.dispatch,a.progroupdata,a.roledata),n={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}};return w.default.createElement("div",null,w.default.createElement(o.default,{type:"primary",icon:"plus",onClick:function(){return e.handleModalVisible(!0)}},"添加用户"),w.default.createElement(r.default,{title:"添加用户",visible:this.state.modalVisible,onOk:this.handleAdd,width:600,onCancel:function(){return e.handleModalVisible()}},w.default.createElement(S,(0,u.default)({},n,{label:"用户名"}),t("username",{rules:[{required:!0,message:"请输入用户名"}]})(w.default.createElement(m.default,{placeholder:"请输入用户名"}))),w.default.createElement(S,(0,u.default)({},n,{label:"用户密码"}),t("password",{rules:[{required:!0,message:"用户密码"}]})(w.default.createElement(m.default,{placeholder:"用户密码"}))),w.default.createElement(S,(0,u.default)({},n,{label:"角色"}),t("role")(w.default.createElement(g.default,{style:{width:120},showSearch:!0,placeholder:"角色",onChange:this.handleSelectLineValue,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return w.default.createElement(k,{key:e.ID,value:e.ID},e.title)})))),w.default.createElement(S,(0,u.default)({},n,{label:"邮箱"}),t("email",{rules:[{required:!0,message:"请输入用户邮箱"}]})(w.default.createElement(m.default,{placeholder:"邮箱"}))),w.default.createElement(S,(0,u.default)({},n,{label:"真实姓名"}),t("realname",{rules:[{}]})(w.default.createElement(m.default,{placeholder:"请输入真实姓名"}))),w.default.createElement(S,(0,u.default)({},n,{label:"手机号"}),t("phone",{rules:[{required:!0,message:"请输入手机号"}]})(w.default.createElement(m.default,{placeholder:"请输入手机号"}))),w.default.createElement(S,(0,u.default)({},n,{label:"用户状态"}),t("enable")(w.default.createElement(d.default,{checkedChildren:"开启",unCheckedChildren:"关闭",checked:this.state.enable,onChange:function(t){return e.handleStatusChange(t)}})))))}}]),t}(w.PureComponent))||y)||y);t.default=I},H8Ab:function(e,t,a){"use strict";var l=a("0ZgE"),n=a("VY4n");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("UsS6");var r=l(a("xqAZ"));a("pdEl");var d=l(a("0Hx8"));a("sL9k");var u=l(a("BlmP"));a("hjcW");var o=l(a("Tmqy"));a("wPR8");var i=l(a("cmPo")),s=l(a("rFaQ")),c=l(a("U2oY")),f=l(a("TFzq")),p=l(a("DEU0")),h=l(a("+hkI")),m=l(a("54rf")),g=l(a("oHNe"));a("6ASg");var v=l(a("pKc7"));a("M50D");var b=l(a("5Zb7"));a("0lkx");var y,E,w,C=l(a("gEKc")),S=n(a("bRCM")),k=a("rAnT"),D=l(a("vtht")),I=l(a("36K2")),x=l(a("7TQl")),V=(C.default.Group,b.default.Item,v.default.Option,function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")}),F=(C.default.TextArea,y=(0,k.connect)(function(e){return e}),E=b.default.create(),y(w=E(w=function(e){function t(){var e,a;(0,f.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,h.default)(this,(e=(0,m.default)(t)).call.apply(e,[this].concat(n))),a.state={expandForm:!1,selectedRows:[],formValues:{},userdata:[],roledata:[]},a.handleStandardTableChange=function(e,t,l){var n=a.props.dispatch,r=a.state.formValues,d=Object.keys(t).reduce(function(e,a){var l=(0,c.default)({},e);return l[a]=V(t[a]),l},{}),u=(0,c.default)({currentPage:e.current,pageSize:e.pageSize},r,d);l.field&&(u.sorter="".concat(l.field,"_").concat(l.order)),n({type:"gproline/getUserlist",payload:u})},a.handleFormReset=function(){var e=a.props,t=e.form,l=e.dispatch;t.resetFields(),a.setState({formValues:{}}),l({type:"gproline/getProjectList",payload:{}})},a.toggleForm=function(){a.setState({expandForm:!a.state.expandForm})},a.handleMenuClick=function(e){var t=a.props.dispatch,l=a.state.selectedRows;if(l)switch(e.key){case"remove":t({type:"gproline/getProjectLine",payload:{ID:l.map(function(e){return e.ID}).join(",")},callback:function(){a.setState({selectedRows:[]})}});break;case"approval":t({type:"gproline/getProjectLine",payload:{ID:l.map(function(e){return e.ID}).join(",")},callback:function(){a.setState({selectedRows:[]})}});case"stop":t({type:"gproline/getProjectLine",payload:{ID:l.map(function(e){return e.ID}).join(",")},callback:function(){a.setState({selectedRows:[]})}})}},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSaveData=function(e){var t,l="on";console.log("val",e);var n=e.ID,r=e.email,d=e.enable,u=e.phone,o=e.real_name,i=e.role,c=e.username;e.password;l=d?"on":"off";var f=(t={ID:n,enable:d,role:i,username:c},(0,s.default)(t,"enable",l),(0,s.default)(t,"email",r),(0,s.default)(t,"real_name",o),(0,s.default)(t,"phone",u),t);a.props.dispatch({type:"guser/modifyUser",payload:f})},a.handleDeleteData=function(e){var t=e.ID,l={},n=[];n.push(t),l.ids=n,a.props.dispatch({type:"gproline/deleteProject",payload:{tag:!1,infolist:JSON.stringify(l)}})},a}return(0,g.default)(t,e),(0,p.default)(t,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)({type:"guser/getUserlist"})}},{key:"render",value:function(){var e=this.state,t=e.selectedRows,a=(e.userdata,e.roledata,e.pagination,this.props.form.getFieldDecorator,this.props),l=a.guser,n=a.dispatch;console.log("guser",l);S.default.createElement(i.default,{onClick:this.handleMenuClick,selectedKeys:[]},S.default.createElement(i.default.Item,{key:"remove"},"批量删除"),S.default.createElement(i.default.Item,{key:"approval"},"批量启用"),S.default.createElement(i.default.Item,{key:"stop"},"批量禁用"));return S.default.createElement(r.default,{bordered:!1},S.default.createElement("div",{className:I.default.tableList},S.default.createElement("div",{className:I.default.tableListOperator},S.default.createElement(u.default,{gutter:16},S.default.createElement(o.default,{span:2},S.default.createElement(x.default,{roledata:l.data.data.role_list})))),S.default.createElement(d.default,null," 用户列表 "),S.default.createElement(D.default,{selectedRows:t,dispatch:n,handleSaveData:this.handleSaveData,handleDeleteData:this.handleDeleteData,userdata:l.data.data.user_infos,roledata:l.data.data.role_list,pagination:l.data.pagination,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})))}}]),t}(S.PureComponent))||w)||w);t.default=F},X6dz:function(e,t,a){e.exports={activeChart:"antd-pro-gcmdb-ui-src-components-access-user-index-activeChart",activeChartGrid:"antd-pro-gcmdb-ui-src-components-access-user-index-activeChartGrid",activeChartLegend:"antd-pro-gcmdb-ui-src-components-access-user-index-activeChartLegend"}},vtht:function(e,t,a){"use strict";var l=a("VY4n"),n=a("0ZgE");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("ggfa");var r=n(a("M+wZ"));a("840F");var d=n(a("6eYs"));a("8EHj");var u=n(a("6xKx"));a("pdEl");var o=n(a("0Hx8"));a("9sh3");var i=n(a("r3sT")),s=n(a("U2oY")),c=n(a("bVKW")),f=n(a("TFzq")),p=n(a("DEU0")),h=n(a("+hkI")),m=n(a("54rf")),g=n(a("oHNe"));a("0lkx");var v=n(a("gEKc"));a("6ASg");var b=n(a("pKc7")),y=l(a("bRCM")),E=(n(a("I9Uw")),n(a("X6dz"))),w=b.default.Option,C=function(e){var t=e.editable,a=e.value,l=e.onChange;return y.default.createElement("div",null,t?y.default.createElement(v.default,{style:{margin:"-5px 0"},value:a,onChange:function(e){return l(e.target.value)}}):a)},S=function(e){function t(){var e,a;(0,f.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,h.default)(this,(e=(0,m.default)(t)).call.apply(e,[this].concat(n))),a.state={selectedRowKeys:[],totalCallNo:0,data:[],selectedLine:!1},a.handleRowSelectChange=function(e,t){var l=t.reduce(function(e,t){return e+parseFloat(t.callNo,10)},0);a.props.onSelectRow&&a.props.onSelectRow(t),a.setState({selectedRowKeys:e,totalCallNo:l})},a.handleTableChange=function(e,t,l){a.props.onChange(e,t,l)},a.cleanSelectedKeys=function(){a.handleRowSelectChange([],[])},a}return(0,g.default)(t,e),(0,p.default)(t,[{key:"componentWillReceiveProps",value:function(e){0===e.selectedRows.length&&this.setState({selectedRowKeys:[],totalCallNo:0}),e.userdata&&this.setState({data:e.userdata.map(function(e){return void 0==e.selectStatus&&(e.selectStatus=!0),e})})}},{key:"renderColumns",value:function(e,t,a){var l=this;return y.default.createElement(C,{editable:t.editable,value:e,onChange:function(e){return l.handleChange(e,t.ID,a)}})}},{key:"edit",value:function(e){console.log("key",e);var t=(0,c.default)(this.state.data);console.log("newData",t);var a=t.filter(function(t){return e===t.ID})[0];a&&(console.log("target",a),a.editable=!0,this.setState({data:t.map(function(t){return e==t.ID&&(t.selectStatus=!1),t})}))}},{key:"save",value:function(e){var t=(0,c.default)(this.state.data),a=t.filter(function(t){return e===t.ID})[0];a&&(delete a.editable,void 0===a.role&&(a.role=a.title_id),this.setState({data:t}),this.props.handleSaveData(a))}},{key:"cancel",value:function(e){var t=(0,c.default)(this.state.data),a=t.filter(function(t){return e===t.ID})[0];a&&(delete a.editable,this.setState({data:t.map(function(t){return e==t.ID&&(t.selectStatus=!0),t})}))}},{key:"askdelete",value:function(e){var t=(0,c.default)(this.state.data),a=t.filter(function(t){return e===t.ID})[0];a&&(a.deleteable=!0,this.setState({data:t}))}},{key:"confirmdelete",value:function(e){var t=(0,c.default)(this.state.data),a=t.filter(function(t){return e===t.ID})[0];if(a){var l=t.indexOf(a);l>-1&&t.splice(l,1),a.tag=!1,this.setState({data:t}),this.cacheData=t.map(function(e){return(0,s.default)({},e)}),this.props.handleDeleteData(a)}}},{key:"handleChange",value:function(e,t,a){var l=(0,c.default)(this.state.data),n=l.filter(function(e){return t===e.ID})[0];n&&(n[a]=e,this.setState({data:l}))}},{key:"handleRoleValue",value:function(e,t,a){var l=(0,c.default)(this.state.data),n=l.filter(function(e){return t===e.ID})[0];n&&(n[a]=e,this.setState({data:l,disabled:!1}))}},{key:"handleSelectLineValue",value:function(e,t,a){var l=(0,c.default)(this.state.data),n=l.filter(function(e){return t===e.ID})[0];n&&(n[a]=e,n.group_title="请选择",n.group_id="-1",this.props.dispatch({type:"gproline/getProjectGroupbyId",payload:e}),this.setState({data:l,disabled:!1,selectedLine:!0}))}},{key:"canceldelete",value:function(e){var t=(0,c.default)(this.state.data),a=t.filter(function(t){return e===t.ID})[0];a&&(Object.assign(a,this.cacheData.filter(function(t){return e===t.ID})[0]),delete a.deleteable,this.setState({data:t}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,l=(t.totalCallNo,t.data,this.props),n=l.roledata,s=l.userdata;console.log("console roledata",n);var c=[{title:"用户ID",dataIndex:"ID",key:"ID",width:"120px"},{title:"用户名",dataIndex:"username",key:"username",width:"120px",render:function(t,a){return e.renderColumns(t,a,"username")}},{title:"真实姓名",dataIndex:"real_name",key:"real_name",width:"120px",render:function(t,a){return e.renderColumns(t,a,"real_name")}},{title:"公司邮箱",dataIndex:"email",key:"email",width:"120px",render:function(t,a){return e.renderColumns(t,a,"email")}},{title:"手机号",dataIndex:"phone",key:"phone",width:"200px",render:function(t,a){return e.renderColumns(t,a,"phone")}},{title:"角色",dataIndex:"title",key:"title",width:"150px",render:function(t,a){var l=y.default.createElement(w,{value:"disabled",disabled:!0},"Disabled");return n.length>0&&(l=n.map(function(e){return y.default.createElement(w,{key:e.ID,value:e.ID},e.title)})),y.default.createElement(b.default,{defaultValue:a.title,disabled:a.selectStatus,style:{width:"auto"},onChange:function(t){e.handleRoleValue(t,a.ID,"role")}},l)}},{title:"状态",dataIndex:"enable",key:"enable",width:"150px",render:function(t,a){var l=a.enable;return y.default.createElement("div",null,y.default.createElement(i.default,{checkedChildren:"启用",unCheckedChildren:"禁用",checked:l,onChange:function(t){e.handleChange(t,a.ID,"enable")},disabled:a.selectStatus}))}},{title:"操作",dataIndex:"operation",key:"operation",width:"200px",render:function(t,a){var l=a.editable;a.deleteable;return y.default.createElement("div",{className:"editable-row-operations"},l?y.default.createElement("span",null,y.default.createElement("a",{onClick:function(){return e.save(a.ID)}},"保存"),y.default.createElement(o.default,{type:"vertical"}),y.default.createElement(u.default,{title:"确定取消?",onConfirm:function(){return e.cancel(a.ID)}},y.default.createElement("a",null,"取消"))):y.default.createElement("span",null,y.default.createElement("a",{onClick:function(){return e.edit(a.ID)}},"修改"),y.default.createElement(o.default,{type:"vertical"})),l?y.default.createElement("span",null):y.default.createElement("span",null,y.default.createElement(u.default,{title:"确定删除?",onConfirm:function(){return e.confirmdelete(a.ID)}},y.default.createElement("a",null,"删除")),y.default.createElement("span",null,y.default.createElement(o.default,{type:"vertical"}),y.default.createElement("a",null,"查看密码")),y.default.createElement("span",null,y.default.createElement(o.default,{type:"vertical"}),y.default.createElement("a",null,"修改密码"))))}}],f={showSizeChanger:!0,showQuickJumper:!0},p={selectedRowKeys:a,onChange:this.handleRowSelectChange,getCheckboxProps:function(e){return{disabled:e.disabled}}};return y.default.createElement("div",{className:E.default.standardTable},y.default.createElement("div",{className:E.default.tableAlert},y.default.createElement(d.default,{message:y.default.createElement("div",null,"已选择 ",y.default.createElement("a",{style:{fontWeight:600}},a.length)," 个用户 ",y.default.createElement("a",{onClick:this.cleanSelectedKeys,style:{marginLeft:24}},"取消勾选")),type:"info",showIcon:!0})),y.default.createElement(r.default,{rowKey:function(e){return e.ID},rowSelection:p,dataSource:s,columns:c,pagination:f,onChange:this.handleTableChange}))}}]),t}(y.PureComponent),k=S;t.default=k}}]);