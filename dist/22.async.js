(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{uq5t:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("UsS6");var d=l(a("xqAZ"));a("ggfa");var u=l(a("M+wZ"));a("pdEl");var i=l(a("0Hx8"));a("sGLA");var r=l(a("156k")),c=l(a("pVnL"));a("0lkx");var f=l(a("gEKc"));a("sL9k");var o=l(a("BlmP"));a("hjcW");var s=l(a("Tmqy"));a("8EHj");var m=l(a("6xKx"));a("3PXm");var p=l(a("m2aW"));a("9sh3");var h=l(a("r3sT"));a("xzRB");var y=l(a("TOEs")),b=l(a("MVZn")),g=l(a("RIqP")),E=l(a("lwsE")),v=l(a("W8MJ")),k=l(a("a1gu")),w=l(a("Nsbk")),S=l(a("7W2i"));a("M50D");var x=l(a("5Zb7"));a("6ASg");var C,I,D,V,_=l(a("pKc7")),F=n(a("q1tI")),q=l(a("TXgB")),B=l(a("Y+p1")),P=a("7DNP"),U=a("MuoO"),A=_.default.Option,L=x.default.Item,M=0,O=(C=(0,U.connect)(function(e){return e}),I=x.default.create(),C(D=I(D=function(e){function t(){var e,a;(0,E.default)(this,t);for(var l=arguments.length,n=new Array(l),d=0;d<l;d++)n[d]=arguments[d];return a=(0,k.default)(this,(e=(0,w.default)(t)).call.apply(e,[this].concat(n))),a.state={modalVisible:!1,disabled:!0,cabinetdata:[],baydata:[],idc:[],haspower:!1,addable:!1,baystatus:!1},a.handleSubmit=function(e){var t=a.props,l=t.dispatch,n=t.location,d=a.props.form,u=a.state.baydata;e.preventDefault(),d.validateFields(function(e,t){if(!e){var i={title:d.getFieldValue("title")?d.getFieldValue("title"):"",power:d.getFieldValue("power")?d.getFieldValue("power"):"",idcid:d.getFieldValue("idcid")?d.getFieldValue("idcid"):"",cableport:d.getFieldValue("cableport")?d.getFieldValue("cableport"):"",capacity:d.getFieldValue("capacity")?d.getFieldValue("capacity"):"",status:a.state.haspower?"1":"0",bay_details:JSON.stringify(u)};l({type:"gidc/modifyCabinet",payload:{ID:n.query.id,description:i}})}})},a.handleAdd=function(){console.log("uuid",V);var e=a.state.baydata,t={ID:++V,bay_name:"bay"+M++,host_ip:"\u7a7a (\u65e0\u6cd5\u76f4\u63a5\u4fee\u6539,\u8bf7\u5728\u4e3b\u673a\u5217\u8868\u5173\u8054\u4fee\u6539)",host_sn:"\u7a7a",height:"2U",height_id:2,status:!1,checked:!1};a.setState({baydata:(0,g.default)(e).concat([t]),addable:!0})},a.handleStatusChange=function(e){a.setState({haspower:e})},a.handleBayStatusChange=function(e,t,l){var n=(0,g.default)(a.state.baydata),d=n.filter(function(e){return t===e.ID})[0];d&&(d[l]=e,a.setState({data:n}))},a.handleSelectLineValue=function(e,t,l){var n=(0,g.default)(a.state.baydata),d=n.filter(function(e){return t===e.ID})[0];d&&(d[l]=e,a.setState({data:n}))},a.confirmDelete=function(e){var t=(0,g.default)(a.state.baydata),l=t.filter(function(t){return e===t.ID})[0];if(l){var n=t.indexOf(l);n>-1&&t.splice(n,1),l.tag=!1,a.setState({baydata:t}),a.cacheData=t.map(function(e){return(0,b.default)({},e)})}},a.confirmSave=function(e){var t=(0,g.default)(a.state.baydata),l=t.filter(function(t){return e===t.ID})[0];l&&(l["checked"]=!0,a.setState({data:t}),a.cacheData=t.map(function(e){return(0,b.default)({},e)}))},a.reback=function(){var e=a.props.dispatch;e({type:"gidc/empty"}),e(P.routerRedux.push({pathname:"/resource/idc/cabinet/list"}))},a.handleSelectChange=function(e){console.log("value",e),a.props.form.setFieldsValue({idcid:e})},a}return(0,S.default)(t,e),(0,v.default)(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.dispatch,a=e.location;void 0!==a.query&&(t({type:"gidc/queryCabinetDetail",payload:a.query.id}),t({type:"gidc/queryIDC"}),V=this.props.gidc.cabinetdetail.bay_max_id+1)}},{key:"componentWillReceiveProps",value:function(e){(0,B.default)(e.gidc.cabinetdetail.time4Update,this.props.gidc.cabinetdetail.time4Update)||e.gidc.cabinetdetail&&(0==e.gidc.cabinetdetail.status&&this.setState({haspower:!0}),e.gidc.cabinetdetail.bay_details&&this.setState({baydata:e.gidc.cabinetdetail.bay_details.map(function(e){return e.checked=!0,e})}),this.setState({cabinetdata:e.gidc.cabinetdetail,idc:e.gidc.idc.data}))}},{key:"handleChange",value:function(e,t,a){var l=(0,g.default)(this.state.data),n=l.filter(function(e){return t===e.ID})[0];n&&(n[a]=e,this.setState({data:l}))}},{key:"render",value:function(){var e=this,t=this.state.cabinetdata,a=this.props.form.getFieldDecorator,l={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},n=[{title:"\u673a\u67b6\u540d\u79f0",dataIndex:"bay_name",width:"100px",editable:!0},{title:"\u673a\u67b6\u9ad8\u5ea6",dataIndex:"height",width:"50px",render:function(t,a){return F.default.createElement(_.default,{defaultValue:t,disabled:a.selectStatus,style:{width:"150px"},onChange:function(t){return e.handleSelectLineValue(t,a.ID,"height_id")}},F.default.createElement(A,{key:"1",value:"1"},"1U"),F.default.createElement(A,{key:"2",value:"2"},"2U"),F.default.createElement(A,{key:"3",value:"3"},"4U"),F.default.createElement(A,{key:"4",value:"4"},"8U"))}},{title:"\u670d\u52a1\u5668IP",dataIndex:"host_ip",width:"100px",render:function(e,t){var a=t.host_ip,l={color:"red"};return F.default.createElement("div",{style:l},a)}},{title:"\u670d\u52a1\u5668\u5e8f\u5217\u53f7",dataIndex:"host_sn",width:"100px",render:function(e,t){var a=t.host_sn,l={color:"red"};return F.default.createElement("div",{style:l},a)}},{title:"\u72b6\u6001",dataIndex:"checked",width:"50px",render:function(e,t){return t.checked?F.default.createElement(y.default,{type:"check",style:{fontSize:16,color:"#228B22"}}):F.default.createElement(y.default,{type:"close",style:{fontSize:16,color:"#FF0000"}})}},{title:"\u673a\u67b6\u7a7a\u95f2\u72b6\u6001",dataIndex:"status",width:"50px",render:function(t,a){var l=a.status;return console.log(l),F.default.createElement("div",null,F.default.createElement(h.default,{checkedChildren:"\u5360\u7528",unCheckedChildren:"\u7a7a\u95f2",checked:l,onChange:function(t){return e.handleBayStatusChange(t,a.ID,"status")}}))}},{title:"\u64cd\u4f5c",dataIndex:"ID",key:"ID",className:"".concat(q.default.tableOperation),width:"200px",render:function(t,a){return F.default.createElement("div",{className:"editable-row-operations"},F.default.createElement("span",{style:{marginLeft:20}},F.default.createElement("a",{onClick:function(){return e.confirmSave(a.ID)}},F.default.createElement(p.default,null,"\u4fdd\u5b58"))),F.default.createElement("span",null,F.default.createElement(m.default,{title:"\u786e\u5b9a\u5220\u9664?",onConfirm:function(){return e.confirmDelete(a.ID)}},F.default.createElement("a",{style:{marginLeft:20}},F.default.createElement(p.default,{type:"danger"},"\u5220\u9664")))))}}];return F.default.createElement(d.default,{bordered:!1},F.default.createElement(o.default,{gutter:24,style:{marginBottom:32}},F.default.createElement(s.default,{span:24,key:2,style:{display:"block",fontSize:20}},"\u673a\u67dc\u4fe1\u606f")),F.default.createElement(x.default,{className:"ant-advanced-search-form",onSubmit:this.handleSubmit},F.default.createElement(o.default,{gutter:24},F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u673a\u67dc\u540d\u79f0"},l),a("title",{initialValue:"".concat(t.cabinet_name?t.cabinet_name:"")})(F.default.createElement(f.default,null)))),F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u673a\u67dc\u7535\u91cf"},l),a("power",{initialValue:"".concat(t.power?t.power:"")})(F.default.createElement(f.default,null))))),F.default.createElement(o.default,{gutter:24},F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u6240\u5c5e\u673a\u623f"},l),a("idcid",{initialValue:"".concat(t.idcname?t.idcname:"")})(F.default.createElement(_.default,{style:{width:264},onChange:this.handleSelectChange},this.state.idc.map(function(e,t){return F.default.createElement(A,{key:t,value:e.ID},e.idc_name)}))))),F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u7f51\u53e3\u6570"},l),a("cableport",{initialValue:"".concat(t.cableport?t.cableport:"")})(F.default.createElement(r.default,{min:1,max:100}))))),F.default.createElement(o.default,{gutter:24},F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u673a\u67dc\u5bb9\u91cf"},l),a("capacity",{initialValue:"".concat(t.capacity?t.capacity:"")})(F.default.createElement(r.default,{min:1,max:100})))),F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u673a\u67dc\u72b6\u6001"},l),F.default.createElement(h.default,{checkedChildren:"\u901a\u7535",unCheckedChildren:"\u672a\u901a\u7535",checked:this.state.haspower,onChange:function(t){return e.handleStatusChange(t)}})))),F.default.createElement(o.default,{gutter:24},F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u7a7a\u95f2\u673a\u67b6"},l))),F.default.createElement(s.default,{span:12},F.default.createElement(L,(0,c.default)({label:"\u7a7a\u95f2\u7f51\u53e3"},l)))),F.default.createElement(i.default,{style:{marginBottom:32}}),F.default.createElement(o.default,{gutter:24,style:{marginBottom:32}},F.default.createElement(s.default,{span:24,key:2,style:{display:"block",fontSize:20}},"\u673a\u67b6\u4fe1\u606f")),F.default.createElement(o.default,{gutter:24,style:{marginBottom:32}},F.default.createElement(s.default,{span:24,key:2,style:{display:"block"}},F.default.createElement(p.default,{type:"danger",onClick:this.handleAdd,style:{width:"15%"}},F.default.createElement(y.default,{type:"plus-square"})," \u6dfb\u52a0\u673a\u67b6"))),F.default.createElement(o.default,null,F.default.createElement(u.default,{rowKey:function(e){return e.ID},style:{marginBottom:24},bordered:!0,dataSource:this.state.baydata,columns:n})),F.default.createElement(o.default,{gutter:24,style:{marginBottom:32}},F.default.createElement(s.default,{span:24,style:{textAlign:"left"}},F.default.createElement(p.default,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),F.default.createElement(i.default,{type:"vertical"}),F.default.createElement(p.default,{onClick:function(){return e.reback()}},"\u8fd4\u56de")))))}}]),t}(F.PureComponent))||D)||D);t.default=O}}]);